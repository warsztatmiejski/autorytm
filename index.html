<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Beatmaker</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
            background: #282c34;
            color: white;
        }
        #beatmaker {
            display: grid;
            grid-template-columns: auto 1fr;
            width: 100%;
            height: 100%;
        }
        .track {
            display: flex;
            align-items: center;
            padding: 5px;
        }
        .beat-grid {
            display: grid;
            grid-template-columns: repeat(16, 1fr);
            gap: 2px;
            width: 100%;
            height: 100%;
        }
        .beat {
            width: 100%;
            height: 30px;
            border: 1px solid #555;
            background: #333;
            cursor: pointer;
        }
        .beat.active {
            background: #00ff00;
        }
        select {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div id="beatmaker"></div>
    <script>
        const audioFolder = 'audio/';
        const soundLibrary = [
            'kick.wav',
            'snare.wav',
            'hihat.wav',
            'clap.wav'
        ];

        const numTracks = soundLibrary.length;
        const numBeats = 16;
        let beatGrid = Array.from({ length: numTracks }, () => Array(numBeats).fill(false));
        let currentBeat = 0;
        let sounds = soundLibrary.map(sound => new Audio(audioFolder + sound));

        const beatmakerDiv = document.getElementById('beatmaker');

        function createTrackControls() {
            for (let i = 0; i < numTracks; i++) {
                const trackDiv = document.createElement('div');
                trackDiv.classList.add('track');

                const select = document.createElement('select');
                soundLibrary.forEach((sound, index) => {
                    const option = document.createElement('option');
                    option.value = audioFolder + sound;
                    option.textContent = sound;
                    if (index === i) option.selected = true;
                    select.appendChild(option);
                });
                select.addEventListener('change', (e) => {
                    sounds[i] = new Audio(e.target.value);
                });
                trackDiv.appendChild(select);

                const beatGridDiv = document.createElement('div');
                beatGridDiv.classList.add('beat-grid');

                for (let beat = 0; beat < numBeats; beat++) {
                    const beatDiv = document.createElement('div');
                    beatDiv.classList.add('beat');
                    beatDiv.dataset.track = i;
                    beatDiv.dataset.beat = beat;
                    beatDiv.addEventListener('click', () => {
                        beatGrid[i][beat] = !beatGrid[i][beat];
                        beatDiv.classList.toggle('active');
                    });
                    beatGridDiv.appendChild(beatDiv);
                }
                trackDiv.appendChild(beatGridDiv);
                beatmakerDiv.appendChild(trackDiv);
            }
        }

        function playBeat() {
            for (let track = 0; track < numTracks; track++) {
                if (beatGrid[track][currentBeat]) {
                    sounds[track].currentTime = 0;
                    sounds[track].play();
                }
            }
            currentBeat = (currentBeat + 1) % numBeats;
            highlightCurrentBeat();
        }

        function highlightCurrentBeat() {
            const beatDivs = document.querySelectorAll('.beat');
            beatDivs.forEach(beatDiv => {
                const beat = parseInt(beatDiv.dataset.beat);
                if (beat === currentBeat) {
                    beatDiv.style.backgroundColor = 'rgba(255, 255, 0, 0.2)';
                } else {
                    beatDiv.style.backgroundColor = beatGrid[beatDiv.dataset.track][beat] ? '#00ff00' : '#333';
                }
            });
        }

        setInterval(playBeat, 150); // 150ms per beat (~100 BPM)

        createTrackControls();
    </script>
</body>
</html>